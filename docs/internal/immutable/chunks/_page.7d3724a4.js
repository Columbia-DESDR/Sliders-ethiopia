import{S as he,i as be,s as ye,h as ke,e as ge,a as me,u as $e,t as M,b as E,d as G,c as _e,o as ve,f as R,n as f,g as K,j as T,k as P,l as Q,m as W,p as x,q as A,r as Z,v,w as I,x as O}from"./index.9400ea7e.js";import{B as we}from"./index.bfd1700f.js";import{M as qe,f as Ce,C as De,L as Me,D as pe,a as Ee,b as Se,S as ue,B as Le,c as Re}from"./http_client.890fb503.js";import{d as Te}from"./database.e22c3c3f.js";import{m as U}from"./model_out.448f9c31.js";import{p as xe}from"./params.fb9618ad.js";function Ie(t){return{c:f,l:f,m:f,p:f,i:f,o:f,d:f}}function Oe(t){let d,s,a,i,o,F,n,y,X,w,Y,k,j,q,h,_,C,c,u,D,m,S,g,B,ee={id:"l1",magic:t[10],importFromConvex:t[13],exportToConvex:t[12]};a=new Me({props:ee}),t[14](a);let ne={id:"d1",index:0,dropdown_key:"village"};o=new pe({props:ne}),t[15](o);let te={id:"lc1",name:"line",title:"Climatology",magic:t[10],xAttr:"dekad",yAttr:"average_value",xDomainMin:"1",xDomainMa:"36"};y=new Ee({props:te}),t[16](y);let ae={name:"testCropCal",id:"cc1",magic:t[10],xDomainMin:"1",xDomainMax:"36"};w=new Se({props:ae}),t[17](w);let re={min:"1",max:"36",id:"s1",description:"CHIRPS sum early"};k=new ue({props:re}),t[18](k);let le={min:"1",max:"36",id:"s2",description:"CHIRPS sum late"};q=new ue({props:le}),t[19](q);let se={min:"1",max:"36",id:"s3",description:"Vegetation"};_=new ue({props:se}),t[20](_);let ie={id:"bgc1",name:"Bar Grouped",title:"Payouts",magic:t[10],groupNames:["sum_early","sum_late","vegetation","combined_payout"],xAttr:"year",yAttr:"value",yMax:"1",xDomainMin:"1981",xDomainMax:"2021"};u=new Le({props:ie}),t[21](u);let oe={id:"d2",index:0,dropdown_key:"value"};m=new pe({props:oe}),t[22](m);let de={name:"Matching Table",id:"m1"};return g=new Re({props:de}),t[23](g),{c(){d=K("div"),s=K("div"),T(a.$$.fragment),i=P(),T(o.$$.fragment),F=P(),n=K("div"),T(y.$$.fragment),X=P(),T(w.$$.fragment),Y=P(),T(k.$$.fragment),j=P(),T(q.$$.fragment),h=P(),T(_.$$.fragment),C=P(),c=K("div"),T(u.$$.fragment),D=P(),T(m.$$.fragment),S=P(),T(g.$$.fragment),this.h()},l(e){d=Q(e,"DIV",{class:!0});var b=W(d);s=Q(b,"DIV",{class:!0});var L=W(s);x(a.$$.fragment,L),i=A(L),x(o.$$.fragment,L),L.forEach(G),F=A(b),n=Q(b,"DIV",{class:!0});var p=W(n);x(y.$$.fragment,p),X=A(p),x(w.$$.fragment,p),Y=A(p),x(k.$$.fragment,p),j=A(p),x(q.$$.fragment,p),h=A(p),x(_.$$.fragment,p),p.forEach(G),C=A(b),c=Q(b,"DIV",{class:!0});var $=W(c);x(u.$$.fragment,$),D=A($),x(m.$$.fragment,$),S=A($),x(g.$$.fragment,$),$.forEach(G),b.forEach(G),this.h()},h(){Z(s,"class","grid items-center py-2 col-span-1 md:col-span-2 lg:col-span-2"),Z(n,"class","grid col-span-1"),Z(c,"class","col-span-1"),Z(d,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2")},m(e,b){me(e,d,b),v(d,s),I(a,s,null),v(s,i),I(o,s,null),v(d,F),v(d,n),I(y,n,null),v(n,X),I(w,n,null),v(n,Y),I(k,n,null),v(n,j),I(q,n,null),v(n,h),I(_,n,null),v(d,C),v(d,c),I(u,c,null),v(c,D),I(m,c,null),v(c,S),I(g,c,null),B=!0},p(e,b){const L={};a.$set(L);const p={};o.$set(p);const $={};y.$set($);const ce={};w.$set(ce);const N={};k.$set(N);const z={};q.$set(z);const H={};_.$set(H);const V={};u.$set(V);const r={};m.$set(r);const l={};g.$set(l)},i(e){B||(M(a.$$.fragment,e),M(o.$$.fragment,e),M(y.$$.fragment,e),M(w.$$.fragment,e),M(k.$$.fragment,e),M(q.$$.fragment,e),M(_.$$.fragment,e),M(u.$$.fragment,e),M(m.$$.fragment,e),M(g.$$.fragment,e),B=!0)},o(e){E(a.$$.fragment,e),E(o.$$.fragment,e),E(y.$$.fragment,e),E(w.$$.fragment,e),E(k.$$.fragment,e),E(q.$$.fragment,e),E(_.$$.fragment,e),E(u.$$.fragment,e),E(m.$$.fragment,e),E(g.$$.fragment,e),B=!1},d(e){e&&G(d),t[14](null),O(a),t[15](null),O(o),t[16](null),O(y),t[17](null),O(w),t[18](null),O(k),t[19](null),O(q),t[20](null),O(_),t[21](null),O(u),t[22](null),O(m),t[23](null),O(g)}}}function Be(t){return{c:f,l:f,m:f,p:f,i:f,o:f,d:f}}function Pe(t){let d,s,a={ctx:t,current:null,token:null,hasCatch:!1,pending:Be,then:Oe,catch:Ie,value:33,blocks:[,,,]};return ke(t[11],a),{c(){d=ge(),a.block.c()},l(i){d=ge(),a.block.l(i)},m(i,o){me(i,d,o),a.block.m(i,a.anchor=o),a.mount=()=>d.parentNode,a.anchor=d,s=!0},p(i,o){t=i,$e(a,t,o)},i(i){s||(M(a.block),s=!0)},o(i){for(let o=0;o<3;o+=1){const F=a.blocks[o];E(F)}s=!1},d(i){i&&G(d),a.block.d(i),a.token=null,a=null}}}function Ae(t,d,s){let a,i;_e(t,Te,e=>s(25,a=e)),_e(t,xe,e=>s(26,i=e));let o,F=new we,n=new qe(F);async function y(){return o=await n.backend({id:"defaults_q_backend",type:"query",query:"SELECT gid, chirps_early_first, chirps_early_last, chirps_late_first, chirps_late_last, evi_month FROM admin_raw ORDER BY gid",name:"defaults_q",defaults:i,backend:a}).execute(),o}const X=y(),w={address:"https://rightful-anteater-150.convex.cloud"};let Y=De;const k=new Y(w),j=k.mutation("saveParams"),q=k.query("getParams");let h=null,_=null,C=null,c=null,u=null,D=null,m=null,S=null,g=null,B=null;ve(async()=>{await y(),n.view([u,h,S,D,_,C,c,g,m,B]);const e=n.backend({id:"village_q_backend",type:"query",query:"SELECT gid, village FROM admin_raw ORDER BY gid",name:"villages",defaults:i,backend:a});n.render(e,h);const b=n.backend({id:"climatology_q_backend",type:"query",query:U.climatology.query,name:"climatology",defaults:i,backend:a});n.render(b,g);const L=n.backend({id:"crop_cal_q_backend",type:"query",query:U.crop_cal.query,name:"crops",defaults:i,backend:a});n.render(L,u);const p=n.backend({id:"payout_q_backend",type:"query",query:U.payout_combined.query,name:"payouts",defaults:i,backend:a}),$=n.backend({id:"badyear_q_bbackend",type:"query",query:U.badyear.query,name:"badyear",defaults:i,backend:a});n.render([p,$],D);const ce=n.backend({id:"matching_q_backend",type:"query",query:U.matching.query,defaults:i,backend:a}),N=n.backend({id:"matching_table_backend",type:"matching",matching:Ce,ignore_cols:["year","gid","value"],default_func:"true positive",backend:ce}),z=n.backend({id:"dropdown_matching_q_backend",type:"query",query:"SELECT * FROM (VALUES (0,'true positive'),(1,'true negative'),(2,'average matching')) MATCHING_OPTIONS(idx, value); ",name:"dropdown matching",defaults:null,backend:a});n.render(z,S),n.render(N,m);const H=n.backend({id:"overlays",type:"overlay"});n.render(H,[g,u]),n.connect(H,_.drag,{sum_early:{left:r=>r.left,right:r=>r.right}}),n.connect(H,C.drag,{sum_late:{left:r=>r.left,right:r=>r.right}}),n.connect(H,c.drag,{vegetation:{left:r=>r.left,right:r=>r.right}}),[L,b,p,$,N].forEach(r=>{n.connect(r,_.drag,{sum_early_first:l=>l.left,sum_early_last:l=>l.right}),n.connect(r,C.drag,{sum_late_first:l=>l.left,sum_late_last:l=>l.right}),n.connect(r,c.drag,{vegetation_first:l=>l.left,vegetation_last:l=>l.right}),n.connect(r,h.change,{region:l=>l.gid})}),n.connect(N,S.change,{func_elected:r=>r.value}),n.render(D.brushX,D),n.render(g.brushX,g),n.render(u.brushX,u);const V=(r,l,J)=>o.filter(fe=>fe[l]===r[0].store.val()[l])[0][J];n.dependencies.add(h.change.get("gid"),_,null,(r,l)=>({left:V(l,"gid","chirps_early_first"),right:V(l,"gid","chirps_early_last")})),n.dependencies.add(h.change.get("gid"),C,null,(r,l)=>({left:V(l,"gid","chirps_late_first"),right:V(l,"gid","chirps_late_last")})),n.dependencies.add(h.change.get("gid"),c,null,(r,l)=>{const J={Sep:{start:24,end:27},Oct:{start:27,end:30},Nov:{start:30,end:33}};return{left:J[V(l,"gid","evi_month")].start,right:J[V(l,"gid","evi_month")].end}}),[e,b,L,p,$,N,z].forEach(async r=>{await r.execute()}),H.execute([{sum_early:{left:18,right:21},sum_late:{left:25,right:27},vegetation:{left:30,right:33}}])});function ee(e){R[e?"unshift":"push"](()=>{B=e,s(9,B)})}function ne(e){R[e?"unshift":"push"](()=>{h=e,s(0,h)})}function te(e){R[e?"unshift":"push"](()=>{g=e,s(8,g)})}function ae(e){R[e?"unshift":"push"](()=>{u=e,s(4,u)})}function re(e){R[e?"unshift":"push"](()=>{_=e,s(1,_)})}function le(e){R[e?"unshift":"push"](()=>{C=e,s(2,C)})}function se(e){R[e?"unshift":"push"](()=>{c=e,s(3,c)})}function ie(e){R[e?"unshift":"push"](()=>{D=e,s(5,D)})}function oe(e){R[e?"unshift":"push"](()=>{S=e,s(7,S)})}function de(e){R[e?"unshift":"push"](()=>{m=e,s(6,m)})}return[h,_,C,c,u,D,m,S,g,B,n,X,j,q,ee,ne,te,ae,re,le,se,ie,oe,de]}class je extends he{constructor(d){super(),be(this,d,Ae,Pe,ye,{},null,[-1,-1])}}export{je as default};
